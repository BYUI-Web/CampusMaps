addScript("https://s7.addthis.com/js/300/addthis_widget.js#pubid=xa-51f6872a25a1fb8c",{win:window,doc:document});addScript("https://www.byui.edu/Prebuilt/maps/js/vendor/modernizr-2.6.1.min.js",{doc:document});var campusMap=new CampusMap(options),map=new Map(options);function addScript(a,b){var c=b.doc.createElement("script");c.type="text/javascript";c.src=a;b.doc.getElementsByTagName("body")[0].appendChild(c)} function addCSS(a,b){var c=b.doc.createElement("link");c.setAttribute("rel","stylesheet");c.href=a;b.doc.getElementsByTagName("body")[0].appendChild(c)}"function"!==typeof String.prototype.trim&&(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}); function CampusMap(a){this.element=a.element?a.element:console.log("No element provided.");this.menuState=a.menuState?a.menuState:1;this.includeMenus=null==a.includeMenus?!0:a.includeMenus;this.KMLFiles=a.categories?a.categories:console.log("No KML Files specified");this.device=0;this.categories=[];this.globals={doc:document,win:window};addCSS("//http://www.byui.edu/prebuilt/maps/css/map.css",this.globals);addScript("https://maps.googleapis.com/maps/api/js?v=3&sensor=false&callback=campusMap.initializeMaps",this.globals)} CampusMap.prototype.initializeMaps=function(){map.embedOptions.embed&&(this.globals.doc.getElementById(this.element).className+=" embed");this.buildHTML();map.initiateMap(this.globals);this.detectDevice();this.loadKMLFiles();this.bindAllEvents();this.includeMenus&&this.bindMenuButton();google.maps.event.addListenerOnce(map.map,"tilesloaded",function(){campusMap.setMapHeight();campusMap.includeMenus&&(campusMap.buildMapKey(),campusMap.initializeSearch());!1===map.embedOptions.embed?campusMap.anchorLocation(): campusMap.includeMenus||campusMap.displayAll();campusMap.getLocation()})}; CampusMap.prototype.buildHTML=function(){var a=this.includeMenus?'<div id="title"><h1 id="heading">BYU-Idaho Campus Map</h1><a style="display: none;" id="device_type" href="#" onmousedown="toggleDevice(); return false;" title="Switch Device Type"><div id="device_container"><div class="device icon-desktop"></div><div class="device icon-mobile"></div></div></a><a id="menu_button" class="icon-settings" href="#" title="Open Menu. Click this or press [space] bar"></a></div>':"",a=a+'<div id="container" name="container">'+ (this.includeMenus?'<div id="menu" name="menu" style="display:block; z-index: 2;"><div id="inner_menu" class="scrolling-element-class" ><div id="object_search"><div class="search-wrapper"><input type="text" placeholder="Search"/><span class="icon-cancel"></span></div></div><nav id="categories" class="child-element"></nav>\x3c!-- // categories --\x3e</div>\x3c!-- // inner menu --\x3e</div>\x3c!-- // menu --\x3e':""),a=a+'<div id="map_canvas"><div id="nojs-msg"><br/>This BYU-Idaho Campus Map application requires Javascript to run. <br/>Your device or browser doesn\'t appear to have JavaScript enabled. <br/>Please enable it and try again, or try another device or browser.</div></div>', a=a+'<div id="map_keys"></div>';this.globals.doc.getElementById(this.element).innerHTML=a}; CampusMap.prototype.loadKMLFiles=function(a){for(var b=this,c=localStorage?localStorage.mapData:void 0,e=c?JSON.parse(c):{},c=0,d=this.KMLFiles.length;c<d;c++){var f=this.KMLFiles[c],g=f.split("."),h=g[g.length-2];if(e[h])this.buildCategories(e[h]);else{var k;k=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");k.onreadystatechange=function(){if(4==k.readyState){var c=new KMLParser(k.responseText);e[h]=c;b.buildCategories(c);a&&"function"===typeof a&&a()}};k.open("GET", f,!1);k.send()}}localStorage.mapData=JSON.stringify(e)}; CampusMap.prototype.buildCategories=function(a){var b=this.categories.length;this.categories[b]=new Category(b+1,a.categoryName,a.categoryName,a.categoryText,a.categoryColor,a.link,this.globals,"cat_"+(b+1));this.categories[b].markerLocations=this.parseLocations(a.Locations,"http://www.byui.edu/Prebuilt/maps/imgs/icons/numeral-icons/"+a.categoryColor+"/");this.categories[b].polygonLocations=this.parseAreas(a.Areas);this.includeMenus&&(a=this.globals.doc.getElementById("categories"),b=this.categories[b].getCatDOMObj(), a.appendChild(b))};CampusMap.prototype.parseLocations=function(a,b){for(var c=[],e=0,d=a.length;e<d;e++){var f=a[e];c.push(new Location(f.name,f.code,f.coordinates[0][0],f.coordinates[0][1],f.image,f.hours,f.description,f.link,e,this.globals,this.includeMenus?b+(e+1)+".png":f.icon))}return c};CampusMap.prototype.parseAreas=function(a){for(var b=[],c=0,e=a.length;c<e;c++){var d=a[c];b.push(new Area(d.name,d.code,d.description,d.polygons,this.globals))}return b}; CampusMap.prototype.detectDevice=function(){this.device=800>this.globals.doc.getElementById(this.element).style.width?0:1};CampusMap.prototype.bindAllEvents=function(){for(var a,b=0,c=this.categories.length;b<c;b++)if(a=this.categories[b],this.includeMenus){a.bindEventListener();if(a.markerLocations)for(var e=0,d=a.markerLocations.length;e<d;e++)a.markerLocations[e].bindEventListener();if(a.polygonLocations)for(e=0,d=a.polygonLocations.length;e<d;e++)a.polygonLocations[e].bindEventListener()}}; CampusMap.prototype.buildMapKey=function(){for(var a="",b=0,c=this.categories.length;b<c;b++)a+=this.categories[b].buildMapKey();this.globals.doc.getElementById("map_keys").innerHTML=a;b=0;for(c=this.categories.length;b<c;b++)this.addClickHandler(this.globals.doc.getElementById("poly_key_"+(b+1)).getElementsByTagName("a")[0],function(){this.parentElement.style.display="none"})}; CampusMap.prototype.getMapHeight=function(){var a=this.globals.doc.getElementById(this.element).offsetHeight;return this.includeMenus?a-57:a};CampusMap.prototype.setMapHeight=function(){var a=this.getMapHeight();this.globals.doc.getElementById("container").style.height=a+"px";this.globals.doc.getElementById("map_canvas").style.height=a+"px"}; CampusMap.prototype.initializeSearch=function(){var a=this.globals.doc.getElementById("object_search").children[0].children[0];this.addKeyUpListener(a,function(){campusMap.performSearch(a.value)});this.addClickHandler(a.nextSibling,function(){a.value="";campusMap.performSearch("")})}; CampusMap.prototype.performSearch=function(a){if(""!=a){a=a.toLowerCase();for(var b=0,c=this.categories.length;b<c;b++){var e=this.categories[b],d=(e.markerLocations?e.markerLocations.length:0)+(e.polygonLocations?e.polygonLocations.length:0);if(e.markerLocations)for(var f=0,g=e.markerLocations.length;f<g;f++)-1===e.markerLocations[f].name.toLowerCase().indexOf(a)?(e.markerLocations[f].hideAll(),d--):e.markerLocations[f].showAll();if(e.polygonLocations)for(f=0,g=e.polygonLocations.length;f<g;f++)-1=== e.polygonLocations[f].name.toLowerCase().indexOf(a)?(e.polygonLocations[f].hideAll(),d--):e.polygonLocations[f].showAll();f=this.globals.doc.getElementById(e.elementID).parentElement.children[1];0<d?e.openCategory(f):e.closeCategory(f)}}else for(b=0,c=this.categories.length;b<c;b++)e=this.categories[b],e.markerLocations&&this.categories[b].hideAllMarkers(),e.polygonLocations&&this.categories[b].hideAllPolygons(),f=this.globals.doc.getElementById(e.elementID).parentElement.children[1],e.closeCategory(f)}; CampusMap.prototype.bindMenuButton=function(){this.addClickHandler(this.globals.doc.getElementById("menu_button"),function(){campusMap.toggleMenu()})};CampusMap.prototype.toggleMenu=function(){this.menuState?this.hideMenu():this.showMenu()};CampusMap.prototype.hideMenu=function(){this.menuState=0;this.globals.doc.getElementById("menu").style.width="0"};CampusMap.prototype.showMenu=function(){this.menuState=1;this.globals.doc.getElementById("menu").style.width=""}; CampusMap.prototype.anchorLocation=function(){if(window.location.hash){var a=window.location.hash.substr(1),a=this.findObject(a);a.showAll();void 0===a.polygons&&this.fireEvent(this.globals.doc.getElementById(a.elementID),"click")}}; CampusMap.prototype.findObject=function(a){for(var b=null,c=0,e=this.categories.length;c<e&&null===b;c++){var d=this.categories[c];if(d.markerLocations)for(var f=0,g=d.markerLocations.length;f<g&&null===b;f++)d.markerLocations[f].code===a&&(b=d.markerLocations[f]);if(d.polygonLocations)for(f=0,g=d.polygonLocations.length;f<g&&null===b;f++)d.polygonLocations[f].code===a&&(b=d.polygonLocations[f])}return b}; CampusMap.prototype.displayAll=function(){for(var a=0,b=this.categories.length;a<b;a++){var c=this.categories[a];if(c.markerLocations)for(var e=0,d=c.markerLocations.length;e<d;e++)c.markerLocations[e].showAll();if(c.polygonLocations)for(e=0,d=c.polygonLocations.length;e<d;e++)c.polygonLocations[e].showPolygons()}}; CampusMap.prototype.fireEvent=function(a,b){if(document.createEvent){var c=document.createEvent("HTMLEvents");c.initEvent(b,!0,!0);return!a.dispatchEvent(c)}c=document.createEventObject();return a.fireEvent("on"+b,c)};CampusMap.prototype.addClickHandler=function(a,b){try{a.addEventListener("click",b)}catch(c){a.attachEvent("onclick",b)}};CampusMap.prototype.addKeyUpListener=function(a,b){try{a.addEventListener("keyup",b)}catch(c){a.attachEvent("onkeyup",b)}}; CampusMap.prototype.getLocation=function(){navigator.geolocation&&navigator.geolocation.getCurrentPosition(this.showPosition)};CampusMap.prototype.showPosition=function(a){map.createMarker(a.coords.latitude,a.coords.longitude,"You are here","imgs/icons/youarehere.png").setVisible(!0)}; function KMLParser(a){try{var b=(new DOMParser).parseFromString(a,"text/xml");this.doc=b.childNodes[0].childNodes[1]}catch(c){b=new ActiveXObject("Microsoft.XMLDOM"),b.async="false",b.loadXML(a),this.doc=b.documentElement.firstChild}this.categoryName;this.categoryText;this.categoryColor;this.link;this.image;this.Locations=[];this.Areas=[];this.foundStyles=[];this.parseKML()} KMLParser.prototype.parseKML=function(){var a=this.doc.getElementsByTagName("Folder")[0];this.categoryName=this.getElementText(a.getElementsByTagName("name")[0]);var b=a.getElementsByTagName("description")[0],b=this.extractLinkText(void 0===b?"":this.getElementText(b));this.categoryText=b[1];this.link=b[0];b=this.extractSrcFromImage(this.categoryText);this.categoryColor=b[0].split("//")[1];this.categoryText=b[1];b=this.parseAllObjects(a);this.Locations=b[0];this.Areas=b[1];this.doc=null}; KMLParser.prototype.parseAllObjects=function(a){var b=a.getElementsByTagName("Folder"),c=[],e=[],b=this.convertToArray(b);if(void 0!==b)for(;b.length;){var d=b.length;e.push(this.parsePolygon(b[0]));a.removeChild(b[0]);d===b.length&&b.shift()}a=a.getElementsByTagName("Placemark");if(void 0!==a)for(b=0,d=a.length;b<d;b++)c.push(this.parsePlacemark(a[b]));return[c,e]}; KMLParser.prototype.parsePolygon=function(a){var b={};b.name=this.getElementText(a.getElementsByTagName("name")[0]);b.code=this.extractCode(this.getElementText(a.getElementsByTagName("description")[0]))[0];b.polygons=[];a=a.getElementsByTagName("Placemark");for(var c=0,e=a.length;c<e;c++){var d=a[c],f=this.getColors(this.getElementText(d.getElementsByTagName("styleUrl")[0])),g=d.getElementsByTagName("description")[0];b.polygons.push({name:this.getElementText(d.getElementsByTagName("name")[0]),description:g? this.getElementText(g):"",coordinates:this.parseLatLng(this.getElementText(d.getElementsByTagName("coordinates")[0])),lineColor:f[0],polyColor:f[1]})}return b}; KMLParser.prototype.parsePlacemark=function(a){var b={};b.name=this.getElementText(a.getElementsByTagName("name")[0]);var c=a.getElementsByTagName("description")[0],c=this.extractLinkText(c?this.getElementText(c):"");b.link=c[0];b.description=c[1];c=this.extractSrcFromImage(b.description);b.image=c[0];b.description=c[1];c=this.extractHours(b.description);b.hours=c[0];b.description=c[1];c=this.extractCode(b.description);b.code=c[0];b.description=c[1];b.coordinates=this.parseLatLng(this.getElementText(a.getElementsByTagName("coordinates")[0])); b.icon=this.getIcon(this.getElementText(a.getElementsByTagName("styleUrl")[0]));return b};KMLParser.prototype.parseLatLng=function(a){var b=[];a=a.replace("\n","").trim().split(" ");for(var c=0,e=a.length;c<e;c++){var d=a[c].split(",");b.push([d[1],d[0]])}return b}; KMLParser.prototype.extractLinkText=function(a){var b="";if(void 0!==a){var c=a.indexOf("<a");if(-1!==c){var e=a.indexOf("</a>")+4,b=a.substr(c,e-c);endAnchorPos=b.indexOf(">")+1;b=b.substr(endAnchorPos,b.length-4-endAnchorPos);a=a.substr(0,c)+a.substr(e)}}return[b,a]}; KMLParser.prototype.extractSrcFromImage=function(a){var b="";if(void 0!==a){var c=a.indexOf("<img");if(-1!==c){var e=a.indexOf("/>")+2,b=a.substr(c,e-c);srcStartPos=b.indexOf("src=")+5;b=b.substr(srcStartPos,b.length-srcStartPos-3);a=a.substr(0,c)+a.substr(e)}}return[b,a]};KMLParser.prototype.extractHours=function(a){var b="";if(void 0!==a){var c=a.indexOf("<hours>");if(-1!==c){var e=a.indexOf("</hours>"),b=a.substr(c+7,e-(c+7));a=a.substr(0,c)+a.substr(e+8)}}return[b,a]}; KMLParser.prototype.extractCode=function(a){var b="";if(void 0!==a){var c=a.indexOf("<code>");if(-1!==c){var e=a.indexOf("</code>"),b=a.substr(c+6,e-(c+6));a=a.substr(0,c)+a.substr(e+7)}}return[b,a]}; KMLParser.prototype.getIcon=function(a){var b="";this.foundStyles[a]?b=this.foundStyles[a]:(b=this.getElement(a.substr(1),"StyleMap"),b=this.getElementText(b.getElementsByTagName("styleUrl")[0]).substr(1),b=this.getElement(b,"Style"),b=this.getElementText(b.getElementsByTagName("href")[0]),this.foundStyles[a]=b);return b}; KMLParser.prototype.getColors=function(a){var b="",c="",b=[];this.foundStyles[a]?b=this.foundStyles[a]:(b=this.getElement(a.substr(1),"StyleMap"),b=this.getElementText(b.getElementsByTagName("styleUrl")[0]).substr(1),c=this.getElement(b,"Style"),b=(b=c.getElementsByTagName("LineStyle")[0])?this.getElementText(b.getElementsByTagName("color")[0]).substr(2):"FFFFF",c=(c=c.getElementsByTagName("PolyStyle")[0])?this.getElementText(c.getElementsByTagName("color")[0]).substr(2):"FFFFF",b=["#"+b,"#"+c],this.foundStyles[a]= b);return b};KMLParser.prototype.getElementText=function(a){return void 0===a.textContent?a.text:a.textContent};KMLParser.prototype.getElement=function(a,b){var c=null;try{c=this.doc.querySelector('[id="'+a+'"]'),null===c&&(c=this.getElementByTagName(a,b))}catch(e){c=this.getElementByTagName(a,b)}return c};KMLParser.prototype.getElementByTagName=function(a,b){for(var c=null,e=this.doc.getElementsByTagName(b),d=0,f=e.length;d<f&&null===c;d++)e[d].getAttribute("id")===a&&(c=e[d]);return c}; KMLParser.prototype.convertToArray=function(a){for(var b=[],c=0,e=a.length;c<e;c++)b[c]=a[c];return b}; function Map(a){this.map;this.mapOptions={campusOverlayVisible:null==a.campusOverlay?!0:a.campusOverlay,campusFile:"http://www.byui.edu/Prebuilt/maps/campus_outline.xml",coordinates:void 0!==a.centerCoordinates?a.centerCoordinates:[43.815045,-111.783515]};this.embedOptions={embed:void 0===a.embed?!1:a.embed,zoom:a.zoom?a.zoom:16,mapView:a.mapView?a.mapView:"map"};this.googleMapOptions={};this.infoWindow;this.campusLayer} Map.prototype.initiateMap=function(a){this.setGoogleMapOptions();this.setGoogleMap(a);this.setInfoWindow();this.setCampusLayer()}; Map.prototype.setGoogleMapOptions=function(){var a="map"===this.embedOptions.mapView?google.maps.MapTypeId.ROADMAP:google.maps.MapTypeId.HYBRID;this.googleMapOptions={zoom:this.embedOptions.embed?this.embedOptions.zoom:16,center:new google.maps.LatLng(this.mapOptions.coordinates[0],this.mapOptions.coordinates[1]),mapTypeId:a,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,google.maps.MapTypeId.SATELLITE,google.maps.MapTypeId.HYBRID,google.maps.MapTypeId.TERRAIN]}}}; Map.prototype.setGoogleMap=function(a){google.maps.Polygon.prototype.getCenter=function(){for(var a=this.getPaths().getArray()[0].b,c=a[0].mb,e=a[0].nb,d=a[0].mb,f=a[0].nb,g=1,h=a.length;g<h;g++)a[g].mb<c?c=a[g].mb:a[g].mb>d&&(d=a[g].mb),a[g].nb<e?e=a[g].nb:a[g].nb>f&&(f=a[g].nb);return new google.maps.LatLng(c+(d-c)/2,e+(f-e)/2)};this.map=new google.maps.Map(a.doc.getElementById("map_canvas"),this.googleMapOptions)};Map.prototype.setInfoWindow=function(){this.infoWindow=new google.maps.InfoWindow}; Map.prototype.setCampusLayer=function(){this.campusLayer=new google.maps.KmlLayer(this.mapOptions.campusFile,{suppressInfoWindows:!0,map:this.map,preserveViewport:!0,zoom:18})};Map.prototype.createMarker=function(a,b,c,e){return new google.maps.Marker({position:new google.maps.LatLng(a,b),visible:!1,map:this.map,title:c,icon:e})}; Map.prototype.createInfoWindow=function(a,b){var c=this.infoWindow,e=this.map;google.maps.event.addListener(a,"click",function(){var d="",f=b.name,g,h=b.link,k=b.hours,l=b.phone,m=b.address,n=b.info;b.img&&(g=-1===b.img.indexOf(":")?"Prebuilt/maps/imgs/objects/"+b.img:b.img);d=d+'<div class="infopane">'+("<h2>"+f+"</h2>");d+="<div>";g&&(d+='<img src="'+g+'" alt="'+f+'"',d+=' style="float:right;margin:0 0 10px 10px;',0===campusMap.device&&!0===window.map.embedOptions.embed&&(d+=" width:100px; height:75px;"), d+='"/>');d+='<div class="button-div">';l&&(d+='<a class="phone-call btn btn-large btn-primary icon-call" href="tel:'+l+'" ></a>');h&&(d+='<a href="'+h+'" target="_blank" class="btn btn-large btn-primary">More Info</a>');d+="</div>";k&&(d+='<div class="info-row info-hours"><strong>Hours:</strong> '+k+"</div>");l&&(d+='<div class="info-row info-phone"><strong>Phone:</strong> '+l+"</div>");m&&(d+='<div class="info-row info-address"><strong>Address:</strong> '+m+"</div>");n&&(d+='<div class="info-row info-info"><strong>Info:</strong> '+ n+"</div>");d+="</div>";d+="</div>";d+='<div class="addthis_toolbox addthis_32x32_style addthis_default_style">';d+="<p>Share this location.</p>";d+='<a class="addthis_button_facebook social_button"></a>';d+='<a class="addthis_button_google_plusone_share social_button"></a>';d+='<a class="addthis_button_twitter social_button"></a>';d+='<a class="addthis_button_compact social_button"></a>';d+="</div>";c.setContent(d);c.open(e,a);addthis.toolbox(".addthis_toolbox",{},{url:"http://www.byui.edu/maps#"+ b.code,title:b.name})})}; Map.prototype.createPolygonInfoWindow=function(a,b){var c=this.infoWindow,e=this.map;google.maps.event.addListener(a,"click",function(d){var f;f=b.name;var g=b.info;f='<div class="infopane">'+("<h2>"+f+"</h2>");f+="<div>";g&&(f+='<div class="info-row info-info"><strong>Info:</strong> '+g+"</div>");f+="</div>";f+="</div>";f+='<div class="addthis_toolbox addthis_32x32_style addthis_default_style">';f+="<p>Share this location.</p>";f+='<a class="addthis_button_facebook social_button"></a>';f+='<a class="addthis_button_google_plusone_share social_button"></a>'; f+='<a class="addthis_button_twitter social_button"></a>';f+='<a class="addthis_button_compact social_button"></a>';f+="</div>";c.setContent(f);a.getCenter();c.open(e);c.setPosition(d.latLng);addthis.toolbox(".addthis_toolbox",{},{url:"http://www.byui.edu/maps#"+b.code,title:b.name})})};function Category(a,b,c,e,d,f,g,h){this.id=a;this.name=b;this.title=c;this.text=e;this.iconColor=d;this.link=f;this.markerLocations=[];this.polygonLocations=[];this.state=0;this.elementID=h;this.globals=g} Category.prototype.buildCatDOM=function(){var a=this.globals.doc.createElement("a");a.className="category_bar";a.id=this.elementID;a.setAttribute("href","#");a.innerHTML+='<img class="cat_icon" src="https://www.byui.edu/Prebuilt/maps/imgs/icons/blank-colors/'+this.iconColor+'.png" />';a.innerHTML+='<span class="category_name">'+this.title+"</span>";return a}; Category.prototype.getCatDOMObj=function(){var a=this.globals.doc.createElement("div");a.className="category";a.appendChild(this.buildCatDOM());var b=this.globals.doc.createElement("div");b.className="cat_container";b.innerHTML='<div class="cat_info"><p>'+this.text+'</p><a href="'+this.link+'" target="_blank">'+this.title+" website</a></div>";var c=this.globals.doc.createElement("div"),c=this.appendLocations(c),c=this.appendAreas(c);b.appendChild(c);a.appendChild(b);return a}; Category.prototype.appendLocations=function(a){if(this.markerLocations)for(var b=0,c=this.markerLocations.length;b<c;b++)a.appendChild(this.markerLocations[b].buildLocationDOM());return a};Category.prototype.appendAreas=function(a){if(this.polygonLocations)for(var b=0,c=this.polygonLocations.length;b<c;b++)a.appendChild(this.polygonLocations[b].buildAreaDOM());return a}; Category.prototype.bindEventListener=function(){var a=this;campusMap.addClickHandler(this.globals.doc.getElementById(this.elementID),function(b){b.preventDefault();a.toggle()})};Category.prototype.toggle=function(){var a=this.globals.doc.getElementById(this.elementID).parentElement.children[1];map.infoWindow.close();this.toggleMarkersVisibility();0===this.state?this.openCategory(a):this.closeCategory(a)}; Category.prototype.openCategory=function(a){a.style.display="block";a.style.height="100%";this.state=1};Category.prototype.closeCategory=function(a){a.style.display="none";a.style.height="0";this.state=0};Category.prototype.toggleMarkersVisibility=function(){0===this.state?this.showAllMarkers():this.hideAllMarkers()};Category.prototype.showAllMarkers=function(){if(this.markerLocations)for(var a=0,b=this.markerLocations.length;a<b;a++)this.markerLocations[a].hidden||this.markerLocations[a].marker.setVisible(!0)}; Category.prototype.hideAllMarkers=function(){if(this.markerLocations)for(var a=0,b=this.markerLocations.length;a<b;a++)this.markerLocations[a].showNavigation(),this.markerLocations[a].hideMarker()};Category.prototype.hideAllPolygons=function(){if(this.polygonLocations)for(var a=0,b=this.polygonLocations.length;a<b;a++)this.polygonLocations[a].showNavigation(),this.polygonLocations[a].hideMapKey()}; Category.prototype.buildMapKey=function(){var a="";if(this.polygonLocations){for(var a="<div id='poly_key_"+this.id+"' class='map_key_category map_key_"+this.name+"' style='display: none'><div class='key_title'>"+this.name+" Map Key</div><a class='close icon-cancel nolink' href='#'></a>",b=0,c=this.polygonLocations.length;b<c;b++)a+=this.polygonLocations[b].buildMapKey();a+="</div>"}return a}; function Location(a,b,c,e,d,f,g,h,k,l,m){this.number=k+1;this.name=a;this.code=b;this.lat=c;this.lon=e;this.img=d;this.hours=f;this.info=g;this.link=h;this.icon=m;this.elementID=this.code+"_"+this.number;this.marker;this.globals=l;this.hidden=!1;this.createMarker();this.createInfoWindow()} Location.prototype.buildLocationDOM=function(){var a=this.globals.doc.createElement("a");a.className="object marker_object";a.id=this.elementID;a.name=this.name;a.setAttribute("href","#"+this.code);a.innerHTML+='<img class="obj_icon" src="'+this.icon+'" alt="'+name+'" />';a.innerHTML+='<div class="object_name">'+this.name+"</div>";return a}; Location.prototype.bindEventListener=function(){var a=this;campusMap.addClickHandler(this.globals.doc.getElementById(this.elementID),function(b){b.preventDefault();a.globals.win.location.hash=a.code;a.panToMarker()})};Location.prototype.panToMarker=function(){var a=google.maps.event.addListener(map,"moveend",function(){map.map.fromLatLngToDivPixel(this.marker.getPosition());google.maps.event.removeListener(a)});map.map.panTo(this.marker.getPosition());google.maps.event.trigger(this.marker,"click")}; Location.prototype.createMarker=function(){this.marker=map.createMarker(this.lat,this.lon,this.name,this.icon)};Location.prototype.createInfoWindow=function(){map.createInfoWindow(this.marker,this)};Location.prototype.hideAll=function(){this.hideNavigation();campusMap.includeMenus&&this.hideMarker()};Location.prototype.hideMarker=function(){this.marker.setVisible(!1)};Location.prototype.hideNavigation=function(){this.hidden=!0;this.globals.doc.getElementById(this.elementID).style.display="none"}; Location.prototype.showAll=function(){this.showMarker();campusMap.includeMenus&&this.showNavigation()};Location.prototype.showMarker=function(){this.marker.setVisible(!0)};Location.prototype.showNavigation=function(){this.hidden=!1;this.globals.doc.getElementById(this.elementID).style.display="block"}; function Area(a,b,c,e,d){this.name=a;this.code=b;this.info=c;this.lineColor=e[0].lineColor;this.fillColor=e[0].polyColor;this.polygons=this.createPolygons(e);this.numberOfPolygons=this.polygons.length;this.elementID=this.code+"_poly";this.globals=d;this.state=0;this.hidden=!1;this.attachInfoWindowEvents()} Area.prototype.buildAreaDOM=function(){var a=this.globals.doc.createElement("a");a.className="object polygon";a.id=this.elementID;a.setAttribute("href","#"+this.code);a.innerHTML='<div class="polygon_key" id="poly_'+this.name+'" style="border-color:'+this.lineColor+"; background-color:"+this.fillColor+'"><span>&nbsp;</span></div>';a.innerHTML+='<div class="object_name polygon">'+this.name+"</div>";return a}; Area.prototype.buildMapKey=function(){return'<div class="polygon_key" id="poly_key_'+this.code+'" style="border-color:'+this.borderColor+"; background-color:"+this.fillColor+'">'+this.code+"</div>"};Area.prototype.bindEventListener=function(){var a=this;campusMap.addClickHandler(this.globals.doc.getElementById(this.elementID),function(b){b.preventDefault();a.globals.win.location.hash=a.code;a.togglePolygon()})}; Area.prototype.togglePolygon=function(){var a=this.globals.doc.getElementById(this.elementID).children[0].children[0],b=this.globals.doc.getElementById("poly_key_"+this.code);0===this.state?this.showPolygons(a,b):1===this.state&&this.hidePolygons(a,b)}; Area.prototype.showPolygons=function(a,b){for(var c=0;c<this.numberOfPolygons;c++)this.polygons[c].setVisible(!0);campusMap.includeMenus&&(a.className="icon-checkmark",b.parentElement.style.display="block",b.className="polygon_key active_key");this.state=1}; Area.prototype.hidePolygons=function(a,b){for(var c=0;c<this.numberOfPolygons;c++)this.polygons[c].setVisible(!1);campusMap.includeMenus&&(a.className="",b.className="polygon_key",1>this.globals.doc.querySelectorAll("#"+b.parentElement.id+" .active_key").length&&(b.parentElement.style.display="none"));this.state=0}; Area.prototype.createPolygons=function(a){for(var b=[],c=0,e=a.length;c<e;c++){for(var d=[],f=0,g=a[c].coordinates.length;f<g;f++){var h=a[c].coordinates[f];d.push(new google.maps.LatLng(h[0],h[1]))}b[c]=this.createPolygon(d,a[c].lineColor,1,2,a[c].polyColor,0.75);b[c].setMap(map.map)}return b};Area.prototype.createPolygon=function(a,b,c,e,d,f){return new google.maps.Polygon({paths:a,strokeColor:b,strokeOpacity:c,strokeWeight:e,fillColor:d,fillOpacity:f,visible:!1})}; Area.prototype.hideAll=function(){campusMap.includeMenus&&(this.hideMapKey(),this.hideNavigation())};Area.prototype.hideMapKey=function(){var a=campusMap.includeMenus?this.globals.doc.getElementById(this.elementID).children[0].children[0]:void 0,b=campusMap.includeMenus?this.globals.doc.getElementById("poly_key_"+this.code):void 0;this.hidePolygons(a,b)};Area.prototype.hideNavigation=function(){this.hidden=!0;this.globals.doc.getElementById(this.elementID).style.display="none"}; Area.prototype.showAll=function(){campusMap.includeMenus&&(this.showMapKey(),this.showNavigation())};Area.prototype.showMapKey=function(){var a=campusMap.includeMenus?this.globals.doc.getElementById(this.elementID).children[0].children[0]:void 0,b=campusMap.includeMenus?this.globals.doc.getElementById("poly_key_"+this.code):void 0;this.showPolygons(a,b)};Area.prototype.showNavigation=function(){this.hidden=!1;this.globals.doc.getElementById(this.elementID).style.display="block"}; Area.prototype.attachInfoWindowEvents=function(){for(var a=0;a<this.numberOfPolygons;a++)map.createPolygonInfoWindow(this.polygons[a],this)};